(function(h){"use strict";class u{constructor(e,t){this.__cursorPosition=0,this.__path=[],this.code=e,this.options={specifyStringIndex:!1,...t}}get(e,t){this.__cursorPosition=e,this.__path=[];const s=this.parseUntilToken(0,'{["'.split("")),r=this.code[s];let n;if(r==="{"?n=this.parseObject(s+1):r==="["&&(n=this.parseArray(s+1)),!n?.found)return null;const o=[...this.__path];return this.__cursorPosition=0,this.__path=[],t?o:this.rawPathToString(o)}rawPathToString(e){let t="$";for(const s of e)(s.type==="array"||s.type==="string")&&(t+=`[${s.index}]`),s.type==="object"&&(/[^\w]/.test(s.key)?t+=`["${s.key}"]`:t+=`.${s.key}`);return t}parseArray(e,t=0){if(t===0){const r=this.parseUntilToken(e+1,'{["0123456789tf]'.split(""));if(this.code[r]==="]")return{endIndex:r,found:this.cursorWithin(e,r)}}this.__path.push({type:"array",index:t});const s=this.parseValue(e+1);return s.found||(this.__path.pop(),this.code[s.endIndex]==="]")?s:this.parseArray(s.endIndex+1,t+1)}parseObject(e){const t=this.parseObjectKey(e);if(!t.key||(this.__path.push({type:"object",key:t.key}),t.found))return t;const s=this.parseValue(t.endIndex+1);return s.found||(this.__path.pop(),this.code[s.endIndex]==="}")?s:this.parseObject(s.endIndex+1)}parseObjectKey(e){const t=this.parseUntilToken(e,['"',"}"]);if(this.code[t]==="}")return{endIndex:t,found:this.cursorWithin(e,t)};const s=this.parseUntilToken(t+1,'"',!0),r=this.code.slice(t+1,s),n=this.parseUntilToken(s,":");return{key:r,endIndex:n,found:this.cursorWithin(t,n)}}parseValue(e){const t=this.parseUntilToken(e,'{["0123456789tfn'.split("")),s=this.code[t];let r;if(s==="{"){const i=this.parseObject(t);if(r=i.endIndex,i.found)return i}else if(s==="["){const i=this.parseArray(t);if(r=i.endIndex,i.found)return i}else if(s==='"'){const i=this.parseString(t);if(r=i.endIndex,i.found)return i}else["t","f","n"].includes(s)?r=this.parseAnyLitteral(t):r=this.parseUntilToken(t+1,[",","}","]"," ",`
`])-1;const n=this.parseUntilToken(r+1,[",","}","]"]);return{found:this.cursorWithin(e,r),endIndex:n}}parseString(e){this.__path.push({type:"string",index:this.__cursorPosition-e-1});const t=this.parseUntilToken(e+1,'"',!0);return this.options.specifyStringIndex&&this.cursorWithin(e+1,t-1)?{found:!0,endIndex:t}:(this.__path.pop(),{found:this.cursorWithin(e,t),endIndex:t})}parseAnyLitteral(e){for(;++e<this.code.length;){const t=this.code[e];if(!/[a-zA-Z]/.test(t))return e-1}return e}parseUntilToken(e,t,s=!0){const r=Array.isArray(t)?t:[t];for(;e<this.code.length&&e>=0;){if(r.includes(this.code[e])){if(!s)return e;let n=0;for(;this.code[e-1-n]==="\\";)n+=1;if(n%2===0)return e}e+=1}return e}cursorWithin(e,t){return e<=this.__cursorPosition&&this.__cursorPosition<=t}}h.JsonCursorPath=u})(this.window=this.window||{});
