(function(c){"use strict";class h{constructor(t,e){this.__cursorPosition=0,this.code=t,this.options={specifyStringIndex:!1,...e}}get(t,e){this.__cursorPosition=t;const s=this.parseUntilToken(0,'{["'.split("")),r=this.code[s];let n;r==="{"?n=this.parseObject(s+1,[]):r==="["&&(n=this.parseArray(s+1,[]));let o=n?.path?n.path:[];return e?o:this.rawPathToString(o)}rawPathToString(t){let e="$";for(const s of t)(s.type==="array"||s.type==="string")&&(e+=`[${s.index}]`),s.type==="object"&&(/[^\w]/.test(s.key)?e+=`["${s.key.replace(/"/g,'\\"')}"]`:e+=`.${s.key}`);return e}parseArray(t,e,s=0){if(s===0){const n=this.parseUntilToken(t+1,'{["0123456789tf]'.split(""));if(this.code[n]==="]")return{endIndex:n,found:this.cursorWithin(t,n)}}const r=this.parseValue(t+1,e,{type:"array",index:s});return r.found||this.code[r.endIndex]==="]"?r:this.parseArray(r.endIndex+1,e,s+1)}parseObject(t,e){const s=this.parseObjectKey(t);if(s.found||!s.key)return s;const r=this.parseValue(s.endIndex+1,e,{type:"object",key:s.key});return r.found||this.code[r.endIndex]==="}"?r:this.parseObject(r.endIndex+1,e)}parseObjectKey(t){const e=this.parseUntilToken(t,['"',"}"]);if(this.code[e]==="}")return{endIndex:e,found:this.cursorWithin(t,e)};const s=this.parseUntilToken(e+1,'"',!0),r=this.code.slice(e+1,s),n=this.parseUntilToken(s,":");return{key:r,endIndex:n,found:this.cursorWithin(e,n)}}parseValue(t,e,s){const r=this.parseUntilToken(t,'{["0123456789tfn'.split("")),n=this.code[r];let o;if(n==="{"){const i=this.parseObject(r,[...e,s]);if(o=i.endIndex,i.found)return i}else if(n==="["){const i=this.parseArray(r,[...e,s]);if(o=i.endIndex,i.found)return i}else if(n==='"'){const i=this.parseString(r,[...e,s]);if(o=i.endIndex,i.found)return i}else["t","f","n"].includes(n)?o=this.parseAnyLitteral(r):o=this.parseUntilToken(r+1,[",","}","]"," ",`
`])-1;const a=this.parseUntilToken(o+1,[",","}","]"]),u=this.cursorWithin(t,o);return{found:u,path:u?[...e,s]:void 0,endIndex:a}}parseString(t,e){const s=this.parseUntilToken(t+1,'"',!0);return this.options.specifyStringIndex&&this.cursorWithin(t+1,s-1)?{found:!0,path:[...e,{type:"string",index:this.__cursorPosition-t-1}],endIndex:s}:{found:this.cursorWithin(t,s),path:e,endIndex:s}}parseAnyLitteral(t){for(;++t<this.code.length;){const e=this.code[t];if(!/[a-zA-Z]/.test(e))return t-1}return t}parseUntilToken(t,e,s=!0,r=1){const n=Array.isArray(e)?e:[e];for(;t<this.code.length&&t>=0;){if(n.includes(this.code[t])&&(!s||this.code[t-1]!=="\\"))return t;t+=r}return t}cursorWithin(t,e){return t<=this.__cursorPosition&&this.__cursorPosition<=e}}c.JsonCursorPath=h})(this.window=this.window||{});
