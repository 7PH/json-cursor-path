(function(u){"use strict";const h=class o{constructor(e,t){this.cursorPosition=0,this.path=[],this.code=e,this.options={specifyStringIndex:!1,...t}}get(e,t){if(this.cursorPosition=e,this.path=[],!this.parseValue(0).found)return null;const r=[...this.path];return this.cursorPosition=0,this.path=[],t?r:this.rawPathToString(r)}rawPathToString(e){let t="$";for(const s of e)(s.type==="array"||s.type==="string")&&(t+=`[${s.index}]`),s.type==="object"&&(/[^\w]/.test(s.key)||s.key===""?t+=`["${s.key}"]`:t+=`.${s.key}`);return t}parseArray(e,t=0){if(t===0){const r=this.parseUntilToken(e+1,[...o.TOKEN_VALUE_START,"]"]);if(this.code[r]==="]")return{endIndex:r,found:this.cursorWithin(e,r)}}this.path.push({type:"array",index:t});const s=this.parseValue(e+1);return s.found||(this.path.pop(),this.code[s.endIndex]==="]"||s.endIndex>=this.code.length)?s:this.parseArray(s.endIndex+1,t+1)}parseObject(e){const t=this.parseObjectKey(e);if(typeof t.key>"u"||(this.path.push({type:"object",key:t.key}),t.found))return t;const s=this.parseValue(t.endIndex+1);return s.found||(this.path.pop(),this.code[s.endIndex]==="}")?s:this.parseObject(s.endIndex+1)}parseObjectKey(e){const t=this.parseUntilToken(e,['"',"}"]);if(this.code[t]==="}"||t>=this.code.length)return{endIndex:t,found:this.cursorWithin(e,t)};const s=this.parseUntilToken(t+1,'"'),r=this.code.slice(t+1,s),i=this.parseUntilToken(s,":");return{key:r,endIndex:i,found:this.cursorWithin(t,i)}}parseValue(e){const t=this.parseUntilToken(e,o.TOKEN_VALUE_START),s=this.code[t];let r;if(s==="{"){const n=this.parseObject(t);if(r=n.endIndex,n.found)return n}else if(s==="["){const n=this.parseArray(t);if(r=n.endIndex,n.found)return n}else if(s==='"'){const n=this.parseString(t);if(r=n.endIndex,n.found)return n}else o.TOKEN_LITERAL.includes(s)?r=this.parseAnyLiteral(t):r=this.parseUntilToken(t+1,[...o.TOKEN_SEPARATOR," ",`
`])-1;const i=this.parseUntilToken(r+1,o.TOKEN_SEPARATOR);return{found:this.cursorWithin(e,r),endIndex:i}}getStringCursorIndex(e,t){const s=this.cursorPosition-e;if(s<=0)return 0;let r=-1,i=0;for(;i<s;)this.code[e+1+i]==="\\"?i+=2:i+=1,r++;return Math.max(0,Math.min(r,t-e-2))}parseString(e){const t=this.parseUntilToken(e+1,'"');return this.options.specifyStringIndex&&this.cursorWithin(e,t)?(t-e>1&&this.path.push({type:"string",index:this.getStringCursorIndex(e,t)}),{found:!0,endIndex:t}):{found:this.cursorWithin(e,t),endIndex:t}}parseAnyLiteral(e){for(;++e<this.code.length;){const t=this.code[e];if(!/[a-zA-Z]/.test(t))return e-1}return e}parseUntilToken(e,t){const s=Array.isArray(t)?t:[t];for(;e<this.code.length&&e>=0;){if(s.includes(this.code[e])){let r=0;for(;this.code[e-1-r]==="\\";)r+=1;if(r%2===0)return e}e+=1}return e}cursorWithin(e,t){return e<=this.cursorPosition&&this.cursorPosition<=t}};h.TOKEN_LITERAL=["t","f","n"],h.TOKEN_VALUE_START=["{","[",'"',...h.TOKEN_LITERAL,"0","1","2","3","4","5","6","7","8","9"],h.TOKEN_SEPARATOR=[",","}","]"];let a=h;u.JsonCursorPath=a})(this.window=this.window||{});
